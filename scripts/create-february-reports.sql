-- Create February 2025 Reports based on the attendance data
-- إنشاء تقارير شهر فبراير 2025 بناءً على بيانات الحضور

-- Insert monthly reports for February 2025
INSERT INTO public.monthly_reports (worker_id, month, year, regular_days, friday_days, holiday_days, overtime_hours, total_salary)
SELECT 
    w.id as worker_id,
    2 as month,
    2025 as year,
    CASE 
        WHEN w.employee_id IN ('1820', '2828', '4833', '5855', '8899', '9921', '12930', '201311', '231440', '283017', '303019', '343039', '393055', '403057', '413059', '423066', '433073', '443080', '483089', '504006', '634081', '694106', '804129', '824134') THEN 28
        WHEN w.employee_id IN ('6856', '11923', '171050', '191298', '333026', '383052', '754119', '794128') THEN 28
        WHEN w.employee_id IN ('7861', '14999', '243004', '453082', '584033', '664093', '734116', '845057') THEN 28
        WHEN w.employee_id IN ('151023', '211357', '263009', '473085', '494004', '574026', '594036', '614077', '624078', '834138') THEN 28
        WHEN w.employee_id IN ('13946', '161045', '293018', '8950507') THEN 28
        WHEN w.employee_id IN ('9910', '253006', '273011', '323022', '363048', '564025', '684102', '724113', '764121', '867051', '8830023') THEN 28
        WHEN w.employee_id IN ('3832', '221421', '313020', '353042', '373049', '814131', '774123', '879097') THEN 28
        ELSE 28
    END as regular_days,
    4 as friday_days, -- 4 Fridays in February 2025
    0 as holiday_days, -- No holidays mentioned in the data
    CASE 
        WHEN w.employee_id IN ('4833', '393055', '151023', '211357', '494004', '544015', '654092', '704110') THEN 10
        WHEN w.employee_id IN ('231440', '283017', '343039', '433073', '754119', '794128', '614077') THEN 14
        WHEN w.employee_id IN ('9910', '273011', '564025', '684102') THEN 2
        ELSE 4
    END as overtime_hours,
    -- Calculate total salary: (regular_days * daily_wage) + (friday_days * daily_wage * 1.5) + (overtime_hours * overtime_rate)
    (28 * w.daily_wage) + (4 * w.daily_wage * 1.5) + 
    (CASE 
        WHEN w.employee_id IN ('4833', '393055', '151023', '211357', '494004', '544015', '654092', '704110') THEN 10
        WHEN w.employee_id IN ('231440', '283017', '343039', '433073', '754119', '794128', '614077') THEN 14
        WHEN w.employee_id IN ('9910', '273011', '564025', '684102') THEN 2
        ELSE 4
    END * w.overtime_rate) as total_salary
FROM workers w
WHERE w.employee_id IN (
    '1820', '2828', '3832', '4833', '5855', '6856', '7861', '8899', '9910', '9921', '11923', '12930', '13946', '14999', '151023', '161045', '171050', '181068', '191298', '201311', '211357', '221421', '231440', '243004', '253006', '263009', '273011', '283017', '293018', '303019', '313020', '323022', '333026', '343039', '353042', '363048', '373049', '383052', '393055', '403057', '413059', '423066', '433073', '443080', '453082', '473085', '483089', '494004', '504006', '514009', '524012', '534013', '544015', '554017', '564025', '574026', '584033', '594036', '604038', '614077', '624078', '634081', '644084', '654092', '664093', '674101', '684102', '694106', '704110', '714111', '724113', '734116', '744118', '754119', '764121', '774123', '784124', '794128', '804129', '814131', '824134', '834138', '845057', '855071', '867051', '879097', '8830023', '8950507', '9050553'
);

-- Display success message
SELECT 'تم إنشاء ' || COUNT(*) || ' تقرير شهري لشهر فبراير 2025!' as message FROM monthly_reports WHERE month = 2 AND year = 2025;
