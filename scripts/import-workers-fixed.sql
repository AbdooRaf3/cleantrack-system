-- Import Workers Data - Fixed Version
-- استيراد بيانات العمال - النسخة المحدثة

-- Get the first available supervisor ID
WITH supervisor_ids AS (
  SELECT id, ROW_NUMBER() OVER (ORDER BY full_name) as rn
  FROM public.users 
  WHERE role = 'supervisor'
),
default_supervisor AS (
  SELECT id FROM supervisor_ids WHERE rn = 1
)

-- Insert workers data with proper supervisor assignment
INSERT INTO public.workers (full_name, employee_id, supervisor_id, daily_wage, overtime_rate) 
SELECT 
  worker_name,
  employee_id,
  (SELECT id FROM default_supervisor),
  daily_wage,
  overtime_rate
FROM (
  VALUES
    -- Workers data from the file
    ('محمد إبراهيم محمد إسماعيل', '1820', 8.25, 8.25),
    ('محمد حسن معروف محمد', '2828', 8.25, 8.25),
    ('خالد رمضان محمد إبراهيم', '3832', 9.00, 9.00),
    ('عمرو محمد شحاته محمد', '4833', 9.00, 9.00),
    ('إبراهيم حسن قنديل احمد', '5855', 8.25, 8.25),
    ('إبراهيم عبدالمحسن أمين عثمان', '6856', 9.00, 9.00),
    ('نادي سرحان عبداللطيف إبراهيم', '7861', 8.25, 8.25),
    ('أشرف محمد ذكي محمد', '8899', 8.25, 8.25),
    ('محمد حسن محمد احمد', '9910', 9.00, 9.00),
    ('احمد قياتي عبدالوهاب محمد', '9921', 8.25, 8.25),
    ('إيهاب محمد أبوزيد محمد', '11923', 9.00, 9.00),
    ('رضا مصطفى حمدي مرسي', '12930', 9.00, 9.00),
    ('علاء محمد شحاته محمد', '13946', 8.25, 8.25),
    ('حجازي شحاته محمد', '14999', 8.25, 8.25),
    ('علاء محمد محمد عبدالوهاب', '151023', 8.25, 8.25),
    ('احمد جاد علي حافظ', '161045', 8.25, 8.25),
    ('محمد غزلول عبدالمطلب علي', '171050', 8.25, 8.25),
    ('أشرف محمود إبراهيم محمد', '181068', 8.25, 8.25),
    ('حسن حسني حسن عبدالمجيد', '191298', 8.25, 8.25),
    ('احمد عبدالغني احمد احمد', '201311', 8.25, 8.25),
    ('خالد محمد علي أبوزيد', '211357', 9.00, 9.00),
    ('خالد محمد إبراهيم علي أبوزيد', '221421', 9.00, 9.00),
    ('أشرف عشري محمد مهني', '231440', 8.25, 8.25),
    ('خالد فلاح نجيب محمد', '243004', 8.25, 8.25),
    ('ياسر عبدالعزيز حسن غنيم', '253006', 9.00, 9.00),
    ('طه محمود شحاته بكر', '263009', 9.00, 9.00),
    ('احمد علي احمد علي', '273011', 8.25, 8.25),
    ('ربيع صبيح محمد احمد', '283017', 8.25, 8.25),
    ('أبومهدي زكي السيد', '293018', 9.00, 9.00),
    ('إبراهيم زكي عياد رزق', '303019', 9.00, 9.00),
    ('محمد عبدالرزاق أبوزيد محمد علي', '313020', 8.25, 8.25),
    ('مختار محمد عبدالحميد مرسي', '323022', 8.25, 8.25),
    ('عبدالرحمن عبدالحليم عبدالرحمن حسن', '333026', 9.00, 9.00),
    ('إسماعيل حسن محمود إسماعيل', '343039', 8.25, 8.25),
    ('احمد إبراهيم محمد إسماعيل', '353042', 8.25, 8.25),
    ('رمضان إبراهيم رمضان محمد', '363048', 9.00, 9.00),
    ('احمد إبراهيم عبدالغني محمد', '373049', 9.00, 9.00),
    ('وليد محمد حبشي سعد', '383052', 8.25, 8.25),
    ('رمضان حسين محمد طلبة', '393055', 9.00, 9.00),
    ('سعيد عبدالحليم محمد محمد طلبة', '403057', 9.00, 9.00),
    ('حجازي الدخلي جلوي محمد', '413059', 8.25, 8.25),
    ('رمضان صلاح رجب', '423066', 8.25, 8.25),
    ('عبد الحميد ضاحي مصطفى احمد', '433073', 8.25, 8.25),
    ('خلف إبراهيم محمد إبراهيم', '443080', 9.00, 9.00),
    ('إسماعيل حسن احمد عبدالله', '453082', 9.00, 9.00),
    ('سماح محي أمين احمد', '473085', 8.25, 8.25),
    ('حسن محمد عقل محمد', '483089', 8.25, 8.25),
    ('محمد حسين محمد خالد', '494004', 9.00, 9.00),
    ('خالد محمد علي العطيفي', '504006', 9.00, 9.00),
    ('عمرو عبدالفتاح الريدي فتح الباب', '514009', 9.00, 9.00),
    ('سيد علي إبراهيم عبدالعظيم', '524012', 8.25, 8.25),
    ('محمد احمد خالد احمد', '534013', 9.00, 9.00),
    ('علاء علي حسين مخلوف', '544015', 9.00, 9.00),
    ('احمد حسن توفيق حسن', '554017', 9.00, 9.00),
    ('رضا محمد عبدالخير أبوالخير', '564025', 9.00, 9.00),
    ('وليد خلف عبدالحليم طلبة', '574026', 8.25, 8.25),
    ('رضا محمد عبدالحميد مرسي', '584033', 9.00, 9.00),
    ('إبراهيم مرسي كامل مرسي', '594036', 9.00, 9.00),
    ('كامل احمد محمد أمين', '604038', 9.00, 9.00),
    ('محمد احمد محمد عبدالحليم', '614077', 8.25, 8.25),
    ('ياسر عيد عبدالوهاب علي', '624078', 9.00, 9.00),
    ('محمد حسن عبدالهادي علي', '634081', 9.00, 9.00),
    ('محمد عيد وزير أحمد', '644084', 8.25, 8.25),
    ('محروس بشرى مرزوق يوسف', '654092', 9.00, 9.00),
    ('محمد فلخ السيد علي', '664093', 8.25, 8.25),
    ('علاء حسن راشد عبدالله', '674101', 9.00, 9.00),
    ('رضا خلف عبدالحميد السيد', '684102', 9.00, 9.00),
    ('ياسر عيد محمد شحاته', '694106', 9.00, 9.00),
    ('إبراهيم يوسف السيد علي', '704110', 9.00, 9.00),
    ('محمود رشيد محمود رشيد', '714111', 9.00, 9.00),
    ('عاطف فانوس رزق بطرس', '724113', 9.00, 9.00),
    ('عبدالله محمد محمد عبدالوهاب', '734116', 8.25, 8.25),
    ('رضا سيد عبدالهادي', '744118', 8.25, 8.25),
    ('ياسر جمعه احمد علي', '754119', 8.25, 8.25),
    ('محمود علي احمد علي', '764121', 8.25, 8.25),
    ('أبوغنيمة السيد حسن محمد', '774123', 8.25, 8.25),
    ('محروس جمعه احمد علي', '784124', 8.25, 8.25),
    ('خالد جمال فتحي محمد', '794128', 8.25, 8.25),
    ('عبدالمنعم صلاح راضي شحاته', '804129', 8.25, 8.25),
    ('محمد خالد محمد عبدالحميد', '814131', 8.25, 8.25),
    ('عمرو صلاح إسماعيل إبراهيم', '824134', 8.25, 8.25),
    ('احمد محمد جابر عبدالغني', '834138', 8.25, 8.25),
    ('احمد جمعه احمد علي', '845057', 9.00, 9.00),
    ('محمود رضا السيد عبدالهادي', '855071', 9.00, 9.00),
    ('عبدالرزاق علي حسن حسين', '867051', 9.00, 9.00),
    ('جمعه أبوغنيمه السيد جوليي', '879097', 9.00, 9.00),
    ('خالد محمد عبدالحميد مرسي', '8830023', 9.00, 9.00),
    ('إبراهيم فتحي إبراهيم حسن', '8950507', 8.25, 8.25),
    ('أمين عبدالفتاح علي سيف', '9050553', 9.00, 9.00)
) AS workers_data(worker_name, employee_id, daily_wage, overtime_rate)
ON CONFLICT (employee_id) DO NOTHING;

-- Display success message
SELECT 'تم إضافة ' || COUNT(*) || ' عامل بنجاح!' as message 
FROM workers 
WHERE employee_id IN ('1820', '2828', '3832', '4833', '5855');
